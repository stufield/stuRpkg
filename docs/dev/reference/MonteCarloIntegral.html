<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Monte-Carlo Integration — MonteCarloIntegral • stuRpkg</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Monte-Carlo Integration — MonteCarloIntegral" />

<meta property="og:description" content="Solving indefinite integrals via Monte-Carlo Monte-Carlo integration
of any unknown function of &quot;x&quot; via simulation. Calculates the area under
the curve by picking numerous points and deciding if that point falls
above or below the curve. This demo shows the method of Monte-Carlo
and how it can be used to estimate the integral (area under a function)
over a given interval of &quot;x&quot;. Simulation mimics a random dart thrown
on a dartboard style algorithm." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />

<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-000000-01"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-000000-01');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stuRpkg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/stuRpkg.html">Get Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../news/index.html">Release Notes</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Links</li>
    <li class="divider"></li>
    <li>
      <a href="https://www.tidyverse.org">The Tidyverse</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stufield/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Monte-Carlo Integration</h1>
    <small class="dont-index">Source: <a href='https://github.com/stufield/stuRpkg/blob/master/R/MonteCarloIntegral.R'><code>R/MonteCarloIntegral.R</code></a></small>
    <div class="hidden name"><code>MonteCarloIntegral.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Solving indefinite integrals via Monte-Carlo Monte-Carlo integration
of any unknown function of "x" via simulation. Calculates the area under
the curve by picking numerous points and deciding if that point falls
above or below the curve. This demo shows the method of Monte-Carlo
and how it can be used to estimate the integral (area under a function)
over a given interval of "x". Simulation mimics a random dart thrown
on a dartboard style algorithm.</p>
    
    </div>

    <pre class="usage"><span class='fu'>MonteCarloIntegral</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='no'>interval</span>, <span class='no'>FUN</span>, <span class='kw'>force</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>quick</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>Integer. How many points to use in the estimation. Defaults to 10000</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>Range of "x" over which the function should be evaluated</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>The function to integrate. Can be any function</p></td>
    </tr>
    <tr>
      <th>force</th>
      <td><p>Logical. Should a brute force method be used to find
the maximum of "y". This can sometimes be useful to avoid missing
the global maximum via <code><a href='https://rdrr.io/r/stats/optimize.html'>optimize</a></code>, but is slower
since many points along the function are independently evaluated</p></td>
    </tr>
    <tr>
      <th>quick</th>
      <td><p>Logical. Should a vectorized implementation be used?</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Logical. Should the simulation be plotted upon completion?
This option is ignored if <code>quick = FALSE</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Numeric estimation of the integral (area below the curve). If
<code>quick = FALSE</code>, a real-time plot of the function with randomly added
points colored by above and below the function is generated</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When <code>quick = TRUE</code>, a quicker implementation is used which uses
vectorized random number generation and optional plotting (plotting
is slow). This vectorized version is &gt;100x faster than the "slow" version
when plotting turned off.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This demo is for students to visually see how the Monte-Carlo
Integration works. Includes an iteration counter &amp; a run time indicator.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>put references to the literature/web site here</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/optimize.html'>optimize</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># set objective function to optimize</span>

<span class='no'>mysteryFun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
  <span class='fl'>20</span>*<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></span>(<span class='no'>x</span>, <span class='kw'>mean</span><span class='kw'>=</span>-<span class='fl'>1</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>5</span>) +
    <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>x</span> <span class='kw'>&gt;</span> -<span class='fl'>1.1</span>,
    <span class='fl'>6</span>*<span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>x</span>+<span class='fl'>1</span>,<span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>0.5</span>),
    <span class='fl'>1.5</span>*<span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span>(<span class='kw'>x</span><span class='kw'>=</span>-<span class='no'>x</span>,<span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>5</span>,<span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>0.2</span>)) +
    <span class='fl'>2</span>*<span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fl'>2.75</span>-<span class='no'>x</span>, <span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>0.25</span>)
}

<span class='co'># compare quick=T vs. quick=F</span>

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'>MonteCarloIntegral</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2.98</span>, <span class='fl'>2.98</span>), <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>mysteryFun</span>, <span class='kw'>quick</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>MonteCarloIntegral</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2.98</span>, <span class='fl'>2.98</span>), <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>mysteryFun</span>)
}

<span class='co'># 1000 simulations</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>MC_sims</span>)</div><div class='output co'>#&gt; [1] 17.43649 17.20891 17.36063 17.36099 17.25185 17.30087</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>MC_sims</span>)</div><div class='output co'>#&gt; [1] 17.33164</div><div class='input'>
<span class='co'># Plot histogram of 1000 estimates</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span>(<span class='no'>MC_sims</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"gray75"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Area"</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='fl'>15</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/box.html'>box</a></span>()</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>MC_sims</span>))</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>MC_sims</span>, <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='fl'>1.75</span>), <span class='kw'>lty</span> <span class='kw'>=</span> <span class='st'>"dotted"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='input'><span class='no'>par</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>MC_sims</span>)$<span class='no'>x</span>[<span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>MC_sims</span>)$<span class='no'>y</span>)]
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>v</span> <span class='kw'>=</span> <span class='no'>par</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='st'>"dotted"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='st'>"topleft"</span>, <span class='kw'>legend</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>"Area Est ~ 0.3%f"</span>, <span class='no'>par</span>),
       <span class='kw'>bg</span> <span class='kw'>=</span> <span class='st'>"gray75"</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>0.75</span>)</div><div class='img'><img src='MonteCarloIntegral-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># check that histogram sums to 1</span>
<span class='no'>H</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span>(<span class='no'>MC_sims</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>((<span class='no'>H</span>$<span class='no'>breaks</span>[<span class='fl'>2</span>]-<span class='no'>H</span>$<span class='no'>breaks</span>[<span class='fl'>1</span>]) * <span class='no'>H</span>$<span class='no'>density</span>), <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>10</span>)</div><div class='output co'>#&gt; [1] 1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Stu Field, William Black IV!</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stu Field.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


